<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>LS4YOU ‚Äì Mon Bilan Life Skills & Ressources</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* Approx polices ‚Äì Politica / Muli / Akrobat peuvent √™tre ajout√©es dans ton CSS global */
    @import url("https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&family=Montserrat:wght@600;700&display=swap");

    :root {
      --orange: #f39200;
      --vert: #95c11f;
      --bleu: #2897d5;
      --rose: #d60b52;
      --violet: #a3195b;
      --rouge: #9f3d3f;
      --noir: #171718;
      --bg: #f8f8fb;
    }

    body {
      font-family: "Muli", "Nunito", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background:
        radial-gradient(circle at 0 0, rgba(243,146,0,0.08) 0, transparent 40%),
        radial-gradient(circle at 100% 0, rgba(40,151,213,0.09) 0, transparent 45%),
        radial-gradient(circle at 0 100%, rgba(149,193,31,0.09) 0, transparent 45%),
        #f5f5f8;
      color: var(--noir);
    }

    h1, h2, h3 {
      font-family: "Politica", "Montserrat", system-ui, sans-serif;
    }

    .card {
      border-radius: 20px;
      background: #ffffff;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.06);
      border: 1px solid rgba(0, 0, 0, 0.03);
    }

    .chip {
      border-radius: 999px;
      font-size: 0.75rem;
      padding: 0.25rem 0.6rem;
      background: #f1f5f9;
    }

    .scale-dot {
      width: 52px;
      height: 52px;
      border-radius: 16px;
      border: 2px solid #e2e8f0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.18s ease;
      font-family: "Akrobat", "Montserrat", system-ui, sans-serif;
      font-size: 0.8rem;
      background: #fff;
      gap: 2px;
    }

    .scale-dot span {
      font-size: 0.7rem;
      font-weight: 600;
    }

    .scale-dot:hover {
      transform: translateY(-1px) scale(1.02);
      box-shadow: 0 6px 16px rgba(15, 23, 42, 0.18);
      border-color: var(--bleu);
    }

    .scale-dot.selected {
      background: linear-gradient(135deg, var(--bleu), var(--violet));
      color: #fff;
      border-color: transparent;
      box-shadow: 0 8px 20px rgba(40,151,213,0.45);
    }

    .domain-pill {
      border-radius: 999px;
      padding: 0.25rem 0.8rem;
      font-size: 0.75rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
    }

    .progress-bar {
      height: 0.9rem;
      border-radius: 999px;
      background: #e5e7eb;
      overflow: hidden;
      position: relative;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--orange), var(--bleu), var(--rose));
      width: 0%;
      transition: width 0.4s ease;
    }

    .progress-bar::after {
      content: "";
      position: absolute;
      inset: 0;
      background-image: linear-gradient(
        120deg,
        rgba(255,255,255,0.15) 25%,
        transparent 25%,
        transparent 50%,
        rgba(255,255,255,0.15) 50%,
        rgba(255,255,255,0.15) 75%,
        transparent 75%,
        transparent
      );
      background-size: 24px 24px;
      mix-blend-mode: soft-light;
      pointer-events: none;
    }

    .step-dot {
      width: 12px;
      height: 12px;
      border-radius: 999px;
      background: #e5e7eb;
      transition: all 0.2s ease;
      border: 1px solid #cbd5e1;
    }

    .step-dot.active {
      background: var(--bleu);
      border-color: var(--bleu);
      transform: scale(1.25);
      box-shadow: 0 0 0 4px rgba(40,151,213,0.2);
    }

    .tag-weak {
      background: #fef2f2;
      color: #b91c1c;
    }

    .tag-ok {
      background: #fffbeb;
      color: #92400e;
    }

    .tag-strong {
      background: #ecfdf5;
      color: #166534;
    }

    @media (max-width: 768px) {
      .question-layout {
        flex-direction: column;
        align-items: flex-start;
      }
    }

    .badge {
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,0.06);
      background: #ffffff;
      padding: 0.4rem 0.8rem;
      font-size: 0.75rem;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      box-shadow: 0 4px 10px rgba(15,23,42,0.06);
    }
  </style>
</head>
<body class="min-h-screen">

  <div class="max-w-5xl mx-auto px-4 py-6 md:py-10">
    <!-- Header -->
    <header class="mb-6 md:mb-10">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <div>
          <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white shadow-sm border border-slate-100 mb-2">
            <span class="text-[0.7rem] font-semibold uppercase tracking-wide text-slate-500">Mission Locale</span>
            <span class="w-1 h-1 rounded-full bg-slate-300"></span>
            <span class="text-[0.7rem] text-slate-500">LS4YOU ‚Äì Life Skills</span>
          </div>
          <h1 class="text-2xl md:text-3xl font-bold text-slate-900 flex items-center gap-2">
            üéÆ Mon Bilan Life Skills & Ressources
          </h1>
          <p class="mt-2 text-sm md:text-base text-slate-600 max-w-2xl">
            Tu r√©ponds √† quelques questions, √† ton rythme.  
            <span class="font-semibold">Pas de bonne ou de mauvaise r√©ponse</span> : √ßa sert juste √† voir sur quoi tu peux t‚Äôappuyer et ce qu‚Äôon peut renforcer ensemble.
          </p>
          <p class="mt-1 text-[0.75rem] text-slate-500">
            Si une question ne te parle pas, tu peux la <span class="font-semibold">laisser vide</span>.
          </p>
        </div>

        <!-- Carte progression gamifi√©e -->
        <div class="card px-4 py-3 flex flex-col gap-2 md:w-64">
          <div class="flex items-center justify-between">
            <span class="text-[0.7rem] font-semibold text-slate-500 uppercase tracking-wide">
              Ton avanc√©e
            </span>
            <span id="progress-counter" class="text-sm font-semibold text-slate-900">
              0 / 50
            </span>
          </div>
          <div class="progress-bar rounded-full overflow-hidden">
            <div id="progress-fill" class="progress-fill"></div>
          </div>
          <div class="flex items-center justify-between text-[0.7rem] text-slate-500">
            <span id="xp-label">XP : 0%</span>
            <span id="level-label" class="font-semibold text-slate-700">Niveau 1 ‚Äì D√©couverte</span>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Card -->
    <main class="card p-4 md:p-6">
      <!-- Top info / steps -->
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-4 md:mb-6">
        <div class="flex items-center gap-3">
          <div class="w-11 h-11 rounded-2xl bg-[var(--bleu)] text-white flex flex-col items-center justify-center text-xs font-bold shadow-md">
            <span class="text-[0.65rem] uppercase tracking-wide">Monde</span>
            <span id="domain-index" class="text-sm">1</span>
          </div>
          <div>
            <p class="text-[0.7rem] font-semibold uppercase tracking-wide text-slate-500">
              Th√®me en cours
            </p>
            <h2 id="domain-title" class="text-base md:text-lg font-semibold text-slate-900">
              <!-- rempli en JS -->
            </h2>
          </div>
        </div>
        <div class="flex flex-col items-end gap-1">
          <div class="flex items-center gap-2" id="step-dots">
            <!-- rempli en JS -->
          </div>
          <span class="text-[0.7rem] text-slate-500">11 mondes √† explorer</span>
        </div>
      </div>

      <!-- Description domaine -->
      <div class="mb-4 border border-dashed border-slate-200 rounded-2xl px-3.5 py-3 bg-slate-50">
        <p id="domain-description" class="text-sm text-slate-700">
          <!-- rempli en JS -->
        </p>
      </div>

      <!-- Questions -->
      <div id="questions-container" class="space-y-3 md:space-y-4 mb-6">
        <!-- rempli en JS -->
      </div>

      <!-- L√©gende √©chelle -->
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-2 mb-4">
        <div class="flex flex-wrap items-center gap-2 text-[0.7rem] text-slate-500">
          <span class="badge"><span>üò∂</span> <span>Jamais / presque jamais</span></span>
          <span class="badge"><span>üôÇ</span> <span>Parfois</span></span>
          <span class="badge"><span>üí™</span> <span>Souvent</span></span>
          <span class="badge"><span>üåü</span> <span>Tr√®s souvent</span></span>
        </div>
        <div class="flex flex-wrap gap-1 text-[0.7rem] justify-end">
          <span class="chip">Tu r√©ponds comme tu le sens</span>
          <span class="chip">Tu peux demander √† ton/ta conseiller¬∑e de reformuler</span>
        </div>
      </div>

      <!-- Navigation -->
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
        <button id="prev-btn"
                class="w-full md:w-auto inline-flex items-center justify-center gap-1 px-4 py-2.5 rounded-xl border border-slate-300 text-sm font-semibold text-slate-700 hover:bg-slate-50 disabled:opacity-40 disabled:cursor-not-allowed">
          ‚Üê Monde pr√©c√©dent
        </button>
        <div class="text-[0.7rem] text-slate-500 text-center md:text-left">
          Tu peux revenir en arri√®re √† tout moment. Rien n‚Äôest enregistr√© en dehors de cette page.
        </div>
        <button id="next-btn"
                class="w-full md:w-auto inline-flex items-center justify-center gap-1 px-4 py-2.5 rounded-xl bg-[var(--orange)] text-sm font-semibold text-white hover:brightness-110">
          Monde suivant ‚Üí
        </button>
      </div>

      <!-- Bouton r√©sultats -->
      <div class="mt-6 border-t border-slate-100 pt-4 flex justify-end">
        <button id="results-btn"
                class="inline-flex items-center justify-center gap-2 px-4 py-2.5 rounded-xl bg-[var(--bleu)] text-sm font-semibold text-white hover:brightness-110 disabled:opacity-40 disabled:cursor-not-allowed"
                disabled>
          Voir mon bilan üìä
        </button>
      </div>
    </main>

    <!-- R√©sultats -->
    <section id="results-section" class="mt-8 hidden">
      <div class="card p-4 md:p-6 mb-4">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-3">
          <div>
            <h2 class="text-lg md:text-xl font-bold text-slate-900 mb-1">
              Ton bilan par grand th√®me
            </h2>
            <p class="text-sm text-slate-600">
              Ce bilan est un <span class="font-semibold">support de discussion</span> entre toi et ton/ta conseiller¬∑e.
              Il aide √† construire un plan d‚Äôactions r√©aliste (emploi, formation, sant√©, budget, etc.).
            </p>
          </div>
          <div class="flex flex-wrap gap-2">
            <span id="badge-progress" class="badge">
              üèÖ <span>Badge : D√©couverte</span>
            </span>
          </div>
        </div>

        <div class="overflow-x-auto">
          <table class="min-w-full text-sm border-t border-b border-slate-100">
            <thead class="bg-slate-50">
              <tr>
                <th class="text-left px-3 py-2 font-semibold text-slate-600">Th√®me</th>
                <th class="text-left px-3 py-2 font-semibold text-slate-600">Score (1‚Äì4)</th>
                <th class="text-left px-3 py-2 font-semibold text-slate-600">Ce que √ßa veut dire</th>
              </tr>
            </thead>
            <tbody id="results-table-body" class="divide-y divide-slate-100">
              <!-- rempli en JS -->
            </tbody>
          </table>
        </div>
      </div>

      <div class="grid gap-4 md:grid-cols-2">
        <div class="card p-4">
          <h3 class="text-sm font-semibold text-slate-900 mb-2">Pour toi ‚Äì Ce que tu peux retenir</h3>
          <ul id="youth-summary" class="list-disc list-inside text-xs text-slate-700 space-y-1">
            <!-- rempli en JS -->
          </ul>
        </div>
        <div class="card p-4">
          <h3 class="text-sm font-semibold text-slate-900 mb-2">Pour le/la conseiller¬∑e ‚Äì Rep√®res CEP</h3>
          <ul id="counsellor-summary" class="list-disc list-inside text-xs text-slate-700 space-y-1">
            <!-- rempli en JS -->
          </ul>
        </div>
      </div>
    </section>

  </div>

  <script>
    // --- 11 mondes / domaines avec questions simplifi√©es et neutres ---

    const domains = [
      {
        id: "emploi",
        title: "Emploi ‚Äì chercher et travailler",
        color: "bg-[var(--bleu)]/10 text-[var(--bleu)]",
        description:
          "Ici, on parle de travail : chercher un job, un apprentissage, faire un stage, se pr√©senter √† un employeur.",
        questions: [
          "Je peux expliquer simplement ce que je sais faire.",
          "Si je devais passer un entretien, je saurais √† peu pr√®s quoi dire.",
          "Je sais o√π trouver des annonces (job, stage, apprentissage).",
          "Je peux suivre des consignes au travail ou en stage.",
          "Je peux demander de l‚Äôaide si je ne comprends pas ce qu‚Äôon me demande."
        ]
      },
      {
        id: "formation",
        title: "Formation ‚Äì apprendre et tenir le rythme",
        color: "bg-[var(--orange)]/10 text-[var(--orange)]",
        description:
          "Ici, on parle d‚Äô√©cole, de formation, de cours, d‚Äôateliers : se concentrer, tenir plusieurs semaines, g√©rer la pression.",
        questions: [
          "Je peux rester concentr√©¬∑e un moment quand un sujet m‚Äôint√©resse.",
          "Je peux tenir un rythme de cours plusieurs jours de suite.",
          "Je peux lever la main ou poser une question si je ne comprends pas.",
          "Je peux g√©rer un peu le stress avant un contr√¥le ou une √©valuation.",
          "Si une formation me pla√Æt, je peux m‚Äôy investir s√©rieusement."
        ]
      },
      {
        id: "orientation",
        title: "Orientation ‚Äì projet et id√©es pour la suite",
        color: "bg-[var(--violet)]/10 text-[var(--violet)]",
        description:
          "Ici, on parle de ton avenir : id√©es de m√©tiers, envies, choix, ce que tu aimerais tester.",
        questions: [
          "J‚Äôai au moins une id√©e de m√©tier ou de domaine qui m‚Äôattire.",
          "Je sais dire ce que j‚Äôaime bien faire dans la vie de tous les jours.",
          "Je vois quelques points forts chez moi (ce que je fais plut√¥t bien).",
          "Je sais que j‚Äôai le droit de tester, me tromper et changer d‚Äôavis.",
          "Je vois quelques √©tapes possibles pour avancer (m√™me si tout n‚Äôest pas clair)."
        ]
      },
      {
        id: "mobilite",
        title: "Mobilit√© ‚Äì se d√©placer",
        color: "bg-[var(--vert)]/10 text-[var(--vert)]",
        description:
          "Ici, on parle de d√©placements : bus, train, voiture, covoiturage, marcher, se rep√©rer.",
        questions: [
          "Je peux aller √† mes rendez-vous importants (Mission Locale, m√©decin, etc.).",
          "Je connais au moins une solution pour me d√©placer plus loin de chez moi.",
          "Je peux demander de l‚Äôaide pour organiser un trajet si je ne connais pas l‚Äôendroit.",
          "Les questions de transport me bloquent parfois pour certains projets.",
          "Je sais √† qui en parler si j‚Äôai un souci de transport ou de permis."
        ]
      },
      {
        id: "sante",
        title: "Sant√© & bien-√™tre",
        color: "bg-[var(--rose)]/10 text-[var(--rose)]",
        description:
          "Ici, on parle de ton √©nergie, ton sommeil, tes √©motions, ton stress, ton moral.",
        questions: [
          "Globalement, j‚Äôai assez d‚Äô√©nergie pour ma journ√©e.",
          "Je remarque quand mon stress ou mes √©motions montent trop.",
          "Je connais au moins une chose qui m‚Äôaide √† me calmer ou me poser.",
          "Je connais au moins une personne ou un lieu o√π je peux parler si √ßa ne va pas.",
          "Ma sant√© (physique ou mentale) rend parfois les choses plus difficiles pour moi."
        ]
      },
      {
        id: "logement",
        title: "Logement & lieu de vie",
        color: "bg-slate-100 text-slate-800",
        description:
          "Ici, on parle de l√† o√π tu vis : se sentir en s√©curit√©, pouvoir se reposer, avoir un coin √† toi.",
        questions: [
          "En ce moment, j‚Äôai un endroit o√π je peux dormir en s√©curit√©.",
          "J‚Äôai un minimum de calme pour me reposer.",
          "Mon lieu de vie me permet plus ou moins d‚Äôaller en formation ou au travail.",
          "Si ma situation de logement changeait ou devenait compliqu√©e, je saurais √† qui en parler."
        ]
      },
      {
        id: "citoyennete",
        title: "Relations, droits & participation",
        color: "bg-[var(--rouge)]/10 text-[var(--rouge)]",
        description:
          "Ici, on parle de tes relations avec les autres, de tes droits, de ta place dans les groupes et les projets.",
        questions: [
          "Je peux parler dans un petit groupe si je me sens en confiance.",
          "Je connais au moins une personne adulte qui peut m‚Äô√©couter s√©rieusement.",
          "Je sais que j‚Äôai des droits (sant√©, travail, √©cole‚Ä¶) m√™me si je ne les connais pas tous.",
          "Je pourrais m‚Äôimpliquer dans une activit√© utile (b√©n√©volat, projet, service civique‚Ä¶) si √ßa me parle."
        ]
      },
      {
        id: "finances",
        title: "Argent & budget",
        color: "bg-amber-50 text-amber-900",
        description:
          "Ici, on parle d‚Äôargent : ce qui rentre, ce qui sort, ce que tu peux ou ne peux pas faire avec.",
        questions: [
          "Je sais √† peu pr√®s combien d‚Äôargent j‚Äôai chaque mois.",
          "Je vois quand ma situation d‚Äôargent devient vraiment limite.",
          "Je peux parler d‚Äôargent avec une personne de confiance (pro ou proche).",
          "Je sais qu‚Äôil existe des aides possibles (logement, √©tudes, mobilit√©, etc.).",
          "L‚Äôargent me bloque parfois pour certains projets (permis, logement, sorties, etc.)."
        ]
      },
      {
        id: "loisirs",
        title: "Loisirs, sport & activit√©s",
        color: "bg-teal-50 text-teal-900",
        description:
          "Ici, on parle de ce qui te fait du bien : sport, musique, jeux, dessin, sorties, projets cr√©atifs‚Ä¶",
        questions: [
          "J‚Äôai au moins une activit√© qui me fait du bien (sport, jeu, musique, etc.).",
          "Je prends un peu de temps pour moi dans la semaine.",
          "Je d√©couvre parfois de nouvelles activit√©s ou de nouveaux lieux.",
          "Je vois que certaines activit√©s m‚Äôaident pour mon moral ou ma confiance.",
          "Je vois un petit lien entre certains loisirs et mon futur (comp√©tences, id√©es, rencontres‚Ä¶)."
        ]
      },
      {
        id: "numerique",
        title: "Num√©rique & connexion",
        color: "bg-cyan-50 text-cyan-900",
        description:
          "Ici, on parle de t√©l√©phone, internet, ordi : se connecter, faire des d√©marches, s‚Äôinformer.",
        questions: [
          "J‚Äôai acc√®s r√©guli√®rement √† un t√©l√©phone et √† internet.",
          "Je peux faire ou suivre des d√©marches en ligne avec un peu d‚Äôaide si besoin.",
          "Je sais chercher des infos utiles (emploi, formation, sant√©‚Ä¶) sur internet.",
          "Je fais un minimum attention √† ce que je publie ou envoie en ligne.",
          "Si je suis perdu¬∑e dans une d√©marche en ligne, je sais √† qui demander de l‚Äôaide."
        ]
      },
      {
        id: "mode_vie",
        title: "Rythme & mode de vie",
        color: "bg-lime-50 text-lime-900",
        description:
          "Ici, on parle de ton quotidien : horaires, sommeil, repas, d√©placements, organisation.",
        questions: [
          "Globalement, mes horaires de sommeil me permettent de tenir la journ√©e.",
          "Je peux arriver √† l‚Äôheure quand quelque chose est important pour moi.",
          "Je note ou garde quelque part mes rendez-vous importants.",
          "Je vois ce que je pourrais changer un peu dans mon quotidien pour me sentir mieux.",
          "Je suis pr√™t¬∑e √† tester de petits changements (horaires, habitudes) pour avancer dans un projet."
        ]
      }
    ];

    const TOTAL_QUESTIONS = domains.reduce((sum, d) => sum + d.questions.length, 0);

    let currentDomainIndex = 0;
    const answers = {}; // { "emploi_0": 1..4, ... }

    const domainIndexEl = document.getElementById("domain-index");
    const domainTitleEl = document.getElementById("domain-title");
    const domainDescEl = document.getElementById("domain-description");
    const questionsContainer = document.getElementById("questions-container");
    const stepDotsContainer = document.getElementById("step-dots");
    const prevBtn = document.getElementById("prev-btn");
    const nextBtn = document.getElementById("next-btn");
    const resultsBtn = document.getElementById("results-btn");
    const progressFill = document.getElementById("progress-fill");
    const progressCounter = document.getElementById("progress-counter");
    const xpLabel = document.getElementById("xp-label");
    const levelLabel = document.getElementById("level-label");
    const resultsSection = document.getElementById("results-section");
    const resultsTableBody = document.getElementById("results-table-body");
    const youthSummaryEl = document.getElementById("youth-summary");
    const counsellorSummaryEl = document.getElementById("counsellor-summary");
    const badgeProgress = document.getElementById("badge-progress");

    function renderStepDots() {
      stepDotsContainer.innerHTML = "";
      domains.forEach((d, idx) => {
        const dot = document.createElement("button");
        dot.type = "button";
        dot.className = "step-dot" + (idx === currentDomainIndex ? " active" : "");
        dot.title = d.title;
        dot.addEventListener("click", () => {
          currentDomainIndex = idx;
          renderDomain();
        });
        stepDotsContainer.appendChild(dot);
      });
    }

    function renderDomain() {
      const domain = domains[currentDomainIndex];
      domainIndexEl.textContent = currentDomainIndex + 1;
      domainTitleEl.textContent = domain.title;
      domainDescEl.textContent = domain.description;

      renderStepDots();

      prevBtn.disabled = currentDomainIndex === 0;
      nextBtn.textContent = currentDomainIndex === domains.length - 1
        ? "Terminer les questions ‚Üí"
        : "Monde suivant ‚Üí";

      questionsContainer.innerHTML = "";
      domain.questions.forEach((qText, i) => {
        const qId = `${domain.id}_${i}`;
        const selectedValue = answers[qId];

        const wrapper = document.createElement("div");
        wrapper.className =
          "flex question-layout items-center justify-between gap-4 rounded-2xl border border-slate-100 bg-white px-3.5 py-3";

        const left = document.createElement("div");
        left.className = "flex-1";
        const label = document.createElement("p");
        label.className = "text-sm text-slate-800";
        label.textContent = qText;
        left.appendChild(label);

        const right = document.createElement("div");
        right.className = "flex flex-col items-center gap-1";
        const scale = document.createElement("div");
        scale.className = "flex items-center gap-1.5";

        const labels = {
          1: "üò∂",
          2: "üôÇ",
          3: "üí™",
          4: "üåü"
        };

        for (let lvl = 1; lvl <= 4; lvl++) {
          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = "scale-dot" + (selectedValue === lvl ? " selected" : "");
          btn.innerHTML = `<div>${labels[lvl]}</div><span>${lvl}</span>`;
          btn.setAttribute("aria-label", `Niveau ${lvl} pour cette affirmation`);
          btn.addEventListener("click", () => {
            answers[qId] = lvl;
            renderDomain();
            updateProgress();
          });
          scale.appendChild(btn);
        }

        right.appendChild(scale);
        wrapper.appendChild(left);
        wrapper.appendChild(right);
        questionsContainer.appendChild(wrapper);
      });

      updateProgress();
    }

    function updateProgress() {
      const answeredCount = Object.keys(answers).length;
      const percent = (answeredCount / TOTAL_QUESTIONS) * 100;
      progressFill.style.width = `${percent}%`;
      progressCounter.textContent = `${answeredCount} / ${TOTAL_QUESTIONS}`;
      xpLabel.textContent = `XP : ${Math.round(percent)}%`;

      let levelText = "Niveau 1 ‚Äì D√©couverte";
      if (percent >= 25 && percent < 50) levelText = "Niveau 2 ‚Äì En route";
      else if (percent >= 50 && percent < 75) levelText = "Niveau 3 ‚Äì Avanc√©e";
      else if (percent >= 75 && percent < 100) levelText = "Niveau 4 ‚Äì Presque au bout";
      else if (percent >= 100) levelText = "Niveau 5 ‚Äì Bilan complet";

      levelLabel.textContent = levelText;

      // bouton r√©sultats activ√© si au moins 60 % compl√©t√©
      resultsBtn.disabled = answeredCount < Math.round(TOTAL_QUESTIONS * 0.6);
    }

    prevBtn.addEventListener("click", () => {
      if (currentDomainIndex > 0) {
        currentDomainIndex--;
        renderDomain();
      }
    });

    nextBtn.addEventListener("click", () => {
      if (currentDomainIndex < domains.length - 1) {
        currentDomainIndex++;
        renderDomain();
      }
    });

    resultsBtn.addEventListener("click", () => {
      buildResults();
      resultsSection.classList.remove("hidden");
      resultsSection.scrollIntoView({ behavior: "smooth" });
    });

    function computeDomainScore(domain) {
      const scores = [];
      domain.questions.forEach((qText, i) => {
        const qId = `${domain.id}_${i}`;
        const val = answers[qId];
        if (typeof val === "number") scores.push(val);
      });
      if (!scores.length) return null;
      const avg = scores.reduce((a, b) => a + b, 0) / scores.length;
      return avg;
    }

    function levelTag(score) {
      if (score === null) {
        return { label: "Pas encore r√©pondu", class: "chip" };
      } else if (score < 2) {
        return { label: "√Ä s√©curiser", class: "chip tag-weak" };
      } else if (score < 3) {
        return { label: "√Ä renforcer", class: "chip tag-ok" };
      } else {
        return { label: "Appui possible", class: "chip tag-strong" };
      }
    }

    // Lecture courte pour les jeunes (non-clivante)
    const domainYouthText = {
      emploi: {
        low: "On peut t‚Äôaider √† te sentir plus √† l‚Äôaise pour parler de toi √† un employeur.",
        mid: "Tu as d√©j√† des bases pour parler de travail, on peut consolider tout √ßa.",
        high: "Tu as d√©j√† de bons rep√®res pour le monde du travail, on peut s‚Äôappuyer dessus."
      },
      formation: {
        low: "On peut voir ensemble comment rendre une formation plus supportable pour toi.",
        mid: "Tu peux suivre une formation si elle a du sens pour toi, on peut organiser √ßa.",
        high: "Tu sembles capable de tenir une formation, on peut aller plus loin dans le projet."
      },
      orientation: {
        low: "On peut prendre du temps pour explorer ce qui te pla√Æt et ce qui ne te pla√Æt pas.",
        mid: "Tu as d√©j√† quelques id√©es, on peut les tester et les pr√©ciser.",
        high: "Tu as un cap assez clair, on peut travailler les √©tapes concr√®tes."
      },
      mobilite: {
        low: "Les d√©placements peuvent √™tre un vrai frein, on peut chercher des solutions ensemble.",
        mid: "Tu te d√©brouilles d√©j√† un peu, on peut s√©curiser certains trajets importants.",
        high: "Tu g√®res plut√¥t bien tes d√©placements, √ßa aide pour tes projets."
      },
      sante: {
        low: "Ta sant√© ou ton moral peuvent peser sur ton quotidien, on peut chercher du soutien.",
        mid: "Tu rep√®res d√©j√† des choses, on peut t‚Äôaider √† trouver d‚Äôautres ressources.",
        high: "Tu as d√©j√† quelques strat√©gies pour te sentir mieux, on peut les renforcer."
      },
      logement: {
        low: "Ta situation de logement peut √™tre fragile, c‚Äôest important d‚Äôen parler.",
        mid: "Ton logement tient √† peu pr√®s, on peut voir comment le s√©curiser.",
        high: "Ton lieu de vie semble plut√¥t stable et peut soutenir tes projets."
      },
      citoyennete: {
        low: "On peut t‚Äôaider √† trouver des lieux o√π tu te sens entendu¬∑e et respect√©¬∑e.",
        mid: "Tu as d√©j√† quelques rep√®res, on peut t‚Äôouvrir d‚Äôautres espaces d‚Äôexpression.",
        high: "Tu as de quoi t‚Äôexprimer et t‚Äôimpliquer, √ßa peut √™tre une force pour tes projets."
      },
      finances: {
        low: "L‚Äôargent peut peser lourd, on peut regarder ensemble toutes les aides possibles.",
        mid: "Tu vois √† peu pr√®s ta situation, on peut t‚Äôaider √† mieux la s√©curiser.",
        high: "Tu sembles d√©j√† faire attention √† ton budget, on peut construire des projets avec √ßa."
      },
      loisirs: {
        low: "On peut t‚Äôaider √† trouver des activit√©s qui te font du bien.",
        mid: "Tu as d√©j√† quelques activit√©s, on peut les soutenir ou en d√©couvrir d‚Äôautres.",
        high: "Tes activit√©s peuvent √™tre une vraie force pour ton √©quilibre et tes projets."
      },
      numerique: {
        low: "On peut t‚Äôaccompagner pour les d√©marches en ligne et l‚Äôutilisation des outils.",
        mid: "Tu te d√©brouilles d√©j√† un peu, on peut s√©curiser certaines d√©marches.",
        high: "Tu utilises d√©j√† le num√©rique comme un outil, √ßa peut beaucoup aider."
      },
      mode_vie: {
        low: "On peut chercher ensemble de petits changements pour que ton quotidien soit plus supportable.",
        mid: "Tu tiens d√©j√† ton quotidien, on peut voir comment le rendre plus confortable.",
        high: "Ton rythme tient la route, on peut s‚Äôappuyer dessus pour tes projets."
      }
    };

    function buildResults() {
      resultsTableBody.innerHTML = "";
      const youthLines = [];
      const counsellorLines = [];

      const scores = [];

      domains.forEach((domain) => {
        const score = computeDomainScore(domain);
        scores.push(score);
        const tag = levelTag(score);

        const tr = document.createElement("tr");
        let youthNote = "";
        if (score !== null) {
          if (score < 2) youthNote = domainYouthText[domain.id].low;
          else if (score < 3) youthNote = domainYouthText[domain.id].mid;
          else youthNote = domainYouthText[domain.id].high;
        }

        tr.innerHTML = `
          <td class="px-3 py-2 align-top">
            <div class="flex items-center gap-2">
              <span class="domain-pill ${domain.color}">
                ${domain.title.split("‚Äì")[0].trim()}
              </span>
            </div>
          </td>
          <td class="px-3 py-2 align-top">
            ${
              score === null
                ? '<span class="text-xs italic text-slate-400">Pas encore r√©pondu</span>'
                : `<div class="flex items-center gap-2">
                     <span class="text-sm font-semibold text-slate-900">${score.toFixed(1)} / 4</span>
                     <span class="${tag.class}">${tag.label}</span>
                   </div>`
            }
          </td>
          <td class="px-3 py-2 align-top text-xs text-slate-700">
            ${score === null ? "Tu pourras compl√©ter ce th√®me plus tard si tu veux." : youthNote}
          </td>
        `;
        resultsTableBody.appendChild(tr);

        if (score !== null) {
          if (score >= 3) {
            youthLines.push(
              `‚Ä¢ <strong>${domain.title.split("‚Äì")[0].trim()}</strong> : un th√®me o√π tu as d√©j√† des forces.`
            );
          } else if (score < 2) {
            youthLines.push(
              `‚Ä¢ <strong>${domain.title.split("‚Äì")[0].trim()}</strong> : un th√®me o√π tu peux avoir besoin de soutien, sans que ce soit de ta faute.`
            );
          } else {
            youthLines.push(
              `‚Ä¢ <strong>${domain.title.split("‚Äì")[0].trim()}</strong> : un th√®me o√π tu as d√©j√† des bases, mais o√π on peut t‚Äôaider √† aller plus loin.`
            );
          }

          if (score < 2.5) {
            counsellorLines.push(
              `‚Ä¢ <strong>${domain.title.split("‚Äì")[0].trim()}</strong> : th√®me √† retravailler dans le CEP (score ${score.toFixed(
                1
              )}/4) et √† relier aux ressources Life Skills / partenaires.`
            );
          }
        }
      });

      youthSummaryEl.innerHTML = youthLines.length
        ? youthLines.join("<br/>")
        : '<li class="italic text-slate-500">Compl√©ter quelques th√®mes de plus pour avoir un retour personnalis√©.</li>';

      counsellorSummaryEl.innerHTML = counsellorLines.length
        ? counsellorLines.join("<br/>")
        : '<li class="italic text-slate-500">Aucun th√®me ne ressort comme prioritaire, mais un √©change qualitatif reste important.</li>';

      // Badge global en fonction des r√©ponses
      const answeredCount = Object.keys(answers).length;
      const percent = (answeredCount / TOTAL_QUESTIONS) * 100;
      let badgeText = "üèÖ Badge : D√©couverte";
      if (percent >= 25 && percent < 50) badgeText = "üéØ Badge : En route";
      else if (percent >= 50 && percent < 75) badgeText = "üöÄ Badge : En progression";
      else if (percent >= 75 && percent < 100) badgeText = "üåü Badge : Bilan presque complet";
      else if (percent >= 100) badgeText = "üèÜ Badge : Bilan complet";

      badgeProgress.innerHTML = badgeText;
    }

    // Initialisation
    renderStepDots();
    renderDomain();
  </script>
</body>
</html>
